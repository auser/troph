require "json"
class TrophApi < Troph::Base
    
  server "troph" do
    %w(Presence Join).each do |t|
      eval "add_message_handler Troph::#{t}Handler"
    end
    add_runtime_caller Troph::PeriodicChecker, 1
    announce_presence host
    
    at_run do
      # q = MQ.queue( Troph::QUEUES[:presence] )
      # q.publish(Troph.prepare_message(:presence, :name => "hi"))
    end
  end
  
end